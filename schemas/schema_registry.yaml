version: 1

defaults:
  file_extension: ".nzf"
  delimiter: "Ã‡"
  encoding: "latin-1"
  header: true
  trim_headers: true
  trim_values: true
  allow_additional_columns: true

tables:

  pvr00500:
    file_patterns: [ "*PVR00500*.nzf", "PVR00500.nzf" ]

    # Business meaning of the table (what it represents)
    description: >
      Instrument payment terms and structure settings (caps/floors, index, reset, schedule, conventions).
      Use this table to analyze payment structure features and contractual terms.

    # Helpful for NL queries: alternate names users might say
    aliases:
      - "PVR00500"
      - "portfolio valuation"
      - "valuation results"
      - "pvr"
      - "interest rates"
      - "rates"
      - "payment terms"
      - "coupon"
      - "pricing"
      - "oas"
      - "price"
      - "contract terms"

    # Optional: high-level topics/tags for retrieval
    business_tags:
      - "payment-structure"
      - "portfolio"
      - "pricing"
      - "rates"
      - "terms"
      - "valuation"

    columns:
      InstrumentID:
        type: string
        description: "Instrument id."
        aliases: [ "pool", "security", "instrument", "instrument id" ]

      PaymentStructureID:
        type: string
        description: "Payment structure id."
        aliases: [ "ps id", "structure id", "payment structure", "payment structure id" ]

      SubsqntPayRecastMonth:
        type: int
        description: "Subsqnt pay recast month."
        aliases: [ "subsqnt pay recast month" ]

      PaymentTypeCode:
        type: string
        description: "Payment type code."
        aliases: [ "code", "payment type", "payment type code" ]

      LifeCapPTCpnRtExclGfee:
        type: string
        description: "Life cap ptcpn rt excl gfee."
        aliases: [ "life cap ptcpn rt excl gfee" ]

      LifeFlrPTCpnRtExclGfee:
        type: string
        description: "Life flr ptcpn rt excl gfee."
        aliases: [ "life flr ptcpn rt excl gfee" ]

      SubsqntPayAdjFreqMonth:
        type: int
        description: "Subsqnt pay adj freq month."
        aliases: [ "subsqnt pay adj freq month" ]

      InstrumentCouponTypeCode:
        type: float
        description: "Instrument coupon type code."
        aliases: [ "code", "instrument coupon type", "instrument coupon type code" ]

      PassThruCpnRateInclGFee:
        type: float
        description: "Pass thru cpn rate incl gfee."
        aliases: [ "pass thru cpn rate incl gfee" ]

      PassThroughCouponRate:
        type: float
        description: "Pass through coupon rate."
        aliases: [ "pass through coupon rate" ]

      InitialPaymentRecastMonth:
        type: int
        description: "Initial payment recast month."
        aliases: [ "initial payment recast month" ]

      PaymentHistory:
        type: string
        description: "Payment history."
        aliases: [ "payment history" ]

      PaymentFrequencyTypeCode:
        type: string
        description: "Payment frequency type code."
        aliases: [ "code", "payment frequency type", "payment frequency type code" ]

      PaymentDelayDays:
        type: int
        description: "Payment delay days."
        aliases: [ "payment delay days" ]

      PaymentCapRate:
        type: float
        description: "Payment cap rate."
        aliases: [ "payment cap rate" ]

      AmortizationTerm:
        type: int
        description: "Amortization term."
        aliases: [ "amortization term" ]

      AmortizationTypeCode:
        type: string
        description: "Amortization type code."
        aliases: [ "code", "amortization type", "amortization type code" ]

      DayCountCode:
        type: int
        description: "Day count code."
        aliases: [ "code", "day count", "day count code" ]

      FinalPaymentDate:
        type: date
        description: "Final payment date."
        aliases: [ "date", "final payment date" ]

      GrossMargin:
        type: float
        description: "Gross margin."
        aliases: [ "gross margin" ]

      ARMIndexCode:
        type: string
        description: "Armindex code."
        aliases: [ "code", "armindex", "armindex code" ]

      ARMIndexDescription:
        type: string
        description: "Armindex description."
        aliases: [ "armindex description" ]

      ARMIndexSource:
        type: string
        description: "Armindex source."
        aliases: [ "armindex source" ]

      InitialPaymentAdjMonth:
        type: int
        description: "Initial payment adj month."
        aliases: [ "initial payment adj month" ]

      InitialRateChangeCapRate:
        type: float
        description: "Initial rate change cap rate."
        aliases: [ "initial rate change cap rate" ]

      InitialRateResetPeriod:
        type: float
        description: "Initial rate reset period."
        aliases: [ "initial rate reset period" ]

      LifeCapCouponRate:
        type: float
        description: "Life cap coupon rate."
        aliases: [ "life cap coupon rate" ]

      LifeFloorCouponRate:
        type: float
        description: "Life floor coupon rate."
        aliases: [ "life floor coupon rate" ]

      LookBackPeriod:
        type: string
        description: "Look back period."
        aliases: [ "look back period" ]

      NetMargin:
        type: float
        description: "Net margin."
        aliases: [ "net margin" ]

      NotionalBalanceAmount:
        type: float
        description: "Notional balance amount."
        aliases: [ "amt", "value", "amount", "notional balance amt", "notional balance amount" ]

      NotionalBalanceCode:
        type: float
        description: "Notional balance code."
        aliases: [ "code", "notional balance", "notional balance code" ]

      PayDay:
        type: string
        description: "Pay day."
        aliases: [ "pay day" ]

      SubsqntRtResetFreqMonth:
        type: int
        description: "Subsqnt rt reset freq month."
        aliases: [ "subsqnt rt reset freq month" ]

      SubsqntRateChangeCapRate:
        type: float
        description: "Subsqnt rate change cap rate."
        aliases: [ "subsqnt rate change cap rate" ]

      TradeAmount:
        type: float
        description: "Trade amount."
        aliases: [ "amt", "value", "amount", "trade amt", "trade amount" ]

      ConvertibleIndicator:
        type: bool
        description: "Convertible indicator."
        aliases: [ "convertible indicator" ]

      ConversionDate:
        type: date
        description: "Conversion date."
        aliases: [ "date", "conversion date" ]

      FirstRateResetDate:
        type: date
        description: "First rate reset date."
        aliases: [ "date", "first rate reset date" ]

      FirstPaymentDate:
        type: date
        description: "First payment date."
        aliases: [ "date", "first payment date" ]

      IndexType:
        type: string
        description: "Index type."
        aliases: [ "index type" ]

      IndexTerm:
        type: int
        description: "Index term."
        aliases: [ "index term" ]

      InterestCurrencyCode:
        type: string
        description: "Interest currency code."
        aliases: [ "code", "interest currency", "interest currency code" ]

      InterestAdjConventioLifeCapIndicator:
        type: bool
        description: "Interest adj conventio life cap indicator."
        aliases: [ "interest adj conventio life cap indicator" ]

      LiabLifeCapCouponRate:
        type: float
        description: "Liab life cap coupon rate."
        aliases: [ "liab life cap coupon rate" ]

      LiabLifeFloorCouponRate:
        type: float
        description: "Liab life floor coupon rate."
        aliases: [ "liab life floor coupon rate" ]

      NetProceeds:
        type: string
        description: "Net proceeds."
        aliases: [ "net proceeds" ]

      PaymentStructureTypeCode:
        type: string
        description: "Payment structure type code."
        aliases: [ "code", "type code", "payment type", "structure type", "payment structure type", "payment structure type code" ]

      PaymentCalendarCode:
        type: string
        description: "Payment calendar code."
        aliases: [ "code", "payment calendar", "payment calendar code" ]

      PaymentRollConvention:
        type: string
        description: "Payment roll convention."
        aliases: [ "payment roll convention" ]

      PaymentMethodCode:
        type: string
        description: "Payment method code."
        aliases: [ "code", "payment method", "payment method code" ]

      PrincipalCurrencyCode:
        type: string
        description: "Principal currency code."
        aliases: [ "code", "principal currency", "principal currency code" ]

      RangeAccrualProvisionInd:
        type: bool
        description: "Range accrual provision ind."
        aliases: [ "range accrual provision ind" ]

      RangeNoteSuspensionPeriod:
        type: string
        description: "Range note suspension period."
        aliases: [ "range note suspension period" ]

      RangeNoteObsPeriod:
        type: string
        description: "Range note obs period."
        aliases: [ "range note obs period" ]

      RangeNoteObsCalendarCode:
        type: string
        description: "Range note obs calendar code."
        aliases: [ "code", "range note obs calendar", "range note obs calendar code" ]

      ResetCalendarCode:
        type: string
        description: "Reset calendar code."
        aliases: [ "code", "reset calendar", "reset calendar code" ]

      ResetRollConventionCode:
        type: string
        description: "Reset roll convention code."
        aliases: [ "code", "reset roll convention", "reset roll convention code" ]

      ResetMethodCode:
        type: string
        description: "Reset method code."
        aliases: [ "code", "reset method", "reset method code" ]

      Coefficient:
        type: string
        description: "Coefficient."
        aliases: [ "coefficient" ]

      BLMAmortizationTerm:
        type: int
        description: "Blmamortization term."
        aliases: [ "blmamortization term" ]

      BLMAmortizationTypeCode:
        type: string
        description: "Blmamortization type code."
        aliases: [ "code", "blmamortization type", "blmamortization type code" ]

      BLMPassThroughCouponRate:
        type: float
        description: "Blmpass through coupon rate."
        aliases: [ "blmpass through coupon rate" ]

      LoanServicingFeeRate:
        type: float
        description: "Loan servicing fee rate."
        aliases: [ "loan servicing fee rate" ]

      BLMBorrowerNoteRate:
        type: float
        description: "Blmborrower note rate."
        aliases: [ "blmborrower note rate" ]

      PostModBorrowerNoteRate:
        type: float
        description: "Post mod borrower note rate."
        aliases: [ "post mod borrower note rate" ]

      BestExCouponRate:
        type: float
        description: "Best ex coupon rate."
        aliases: [ "best ex coupon rate" ]

      BuyUpPrice:
        type: float
        description: "Buy up price."
        aliases: [ "buy up price" ]

      BuyDownPrice:
        type: float
        description: "Buy down price."
        aliases: [ "buy down price" ]

      BuyUpBps:
        type: float
        description: "Buy up bps."
        aliases: [ "buy up bps" ]

      BuyDownBps:
        type: string
        description: "Buy down bps."
        aliases: [ "buy down bps" ]

      RepositionTradePrice:
        type: float
        description: "Reposition trade price."
        aliases: [ "reposition trade price" ]

      FrontStubEndDate:
        type: date
        description: "Front stub end date."
        aliases: [ "date", "front stub end date" ]

      BackStubStartDate:
        type: date
        description: "Back stub start date."
        aliases: [ "date", "back stub start date" ]

    # Optional: examples of how the business uses this table (helps NL/RAG)
    examples:
      - "Count instruments by portfolio for a given run/date using PVR00500"
      - "Show key metrics grouped by portfolio or instrument from PVR00500"
      - "Filter by scenario/date fields and summarize results from PVR00500"

  pvr00600:
    file_patterns: [ "*PVR00600*.nzf", "PVR00600.nzf" ]

    # Business meaning of the table (what it represents)
    description: >
      Instrument-level analytics outputs for a valuation run (e.g., OAS, price, duration, WAL, CPR).
      Use this table to analyze pricing and risk measures by instrument and portfolio.

    # Helpful for NL queries: alternate names users might say
    aliases:
      - "PVR00600"
      - "portfolio valuation"
      - "valuation results"
      - "pvr"
      - "pricing"
      - "oas"
      - "price"
      - "analytics"
      - "risk measures"
      - "valuation analytics"

    primary_key: [ "DmrRunID", "PortfolioID", "InstrumentID", "RunID" ]

    # Optional: high-level topics/tags for retrieval
    business_tags:
      - "analytics"
      - "portfolio"
      - "pricing"
      - "risk"
      - "valuation"

    columns:
      DmrRunID:
        type: string
        description: "Dmr run id."
        aliases: [ "run id", "dmr run", "batch id", "dmr run id" ]

      PortfolioID:
        type: string
        description: "Portfolio id."
        aliases: [ "book", "account", "portfolio", "portfolio id" ]

      InstrumentID:
        type: string
        description: "Instrument id."
        aliases: [ "pool",  "security", "instrument", "instrument id" ]

      RunID:
        type: string
        description: "Run id."
        aliases: [ "run", "run id" ]

      Oas:
        type: float
        description: "Oas."
        aliases: [ "oas" ]

      Price:
        type: float
        description: "Price."
        aliases: [ "price" ]

      Duration:
        type: float
        description: "Duration."
        aliases: [ "duration" ]

      WeightedAvgLife:
        type: float
        description: "Weighted avg life."
        aliases: [ "weighted avg life" ]

      CPR1Year:
        type: float
        description: "Cpr1 year."
        aliases: [ "cpr1 year" ]

    # Optional: examples of how the business uses this table (helps NL/RAG)
    examples:
      - "Count instruments by portfolio for a given run/date using PVR00600"
      - "Show key metrics grouped by portfolio or instrument from PVR00600"
      - "Filter by scenario/date fields and summarize results from PVR00600"


joins:
  - left_table: "pvr00500"
    right_table: "pvr00600"
    left_keys: ["InstrumentID"]
    right_keys: ["InstrumentID"]
    join_type: "left"
    description: "Attach contractual payment terms to payment structures"